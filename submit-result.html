<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Result | UT Canoe & Hiking Club</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="assets/styles.css" />
    <script>
      function getParam(name) {
        const url = new URL(window.location.href);
        return url.searchParams.get(name) || "";
      }

      function isSafeReturnTo(value) {
        // Only allow same-site relative paths.
        if (!value) return false;
        if (value.includes("://")) return false;
        return value.startsWith("/");
      }

      document.addEventListener("DOMContentLoaded", () => {
        const ok = getParam("ok") === "1";
        const action = getParam("action");
        const error = getParam("error");
        const tripId = getParam("tripId");
        const rsvpUrl = getParam("rsvpUrl");
        const returnTo = getParam("returnTo");

        const title = document.querySelector("[data-result-title]");
        const status = document.querySelector("[data-result-status]");
        const details = document.querySelector("[data-result-details]");
        const back = document.querySelector("[data-return-link]");

        title.textContent = ok ? "Success" : "Something went wrong";
        status.className = ok ? "status ok" : "status err";
        status.hidden = false;
        status.textContent = ok
          ? "Done."
          : (error || "Submission failed.");

        const lines = [];
        if (action) lines.push(`Action: ${action}`);
        if (tripId) lines.push(`Trip ID: ${tripId}`);
        if (rsvpUrl) lines.push(`RSVP URL: ${rsvpUrl}`);
        details.textContent = lines.join("\n");
        details.hidden = !lines.length;

        if (isSafeReturnTo(returnTo)) {
          back.href = returnTo;
          back.hidden = false;
          setTimeout(() => (window.location.href = returnTo), 1200);
        }
      });
    </script>
  </head>
  <body>
    <a class="skip-link" href="#main">Skip to content</a>

    <header class="site-header">
      <div class="wrap header-inner">
        <a class="brand" href="index.html">
          <img src="UTCH_logo.jpg" alt="UTCH logo" />
          <div class="title">
            <strong>UT Canoe &amp; Hiking Club</strong>
            <span>University of Tennessee</span>
          </div>
        </a>

        <nav class="nav" aria-label="Primary">
          <a href="index.html">Home</a>
          <a href="calendar.html">Calendar</a>
          <a href="rsvp.html">RSVP</a>
          <a href="suggest.html">Suggest</a>
          <a href="about.html">About</a>
          <a href="officer.html">Officer</a>
        </nav>
      </div>
    </header>

    <main id="main">
      <div class="wrap">
        <section class="hero">
          <h1 data-result-title>Result</h1>
          <p>Returning you to the previous pageâ€¦</p>
        </section>

        <section class="grid">
          <article class="card">
            <div class="status" data-result-status hidden></div>
            <pre class="hint" data-result-details hidden style="white-space: pre-wrap; margin-top: 14px;"></pre>
            <div style="margin-top: 16px;">
              <a class="button primary" data-return-link hidden>Back</a>
              <a class="button secondary" href="index.html">Home</a>
            </div>
          </article>
        </section>
      </div>
    </main>

    <footer class="site-footer">
      <div class="wrap">
        <div class="footer-brand">
          <img src="UTCH_logo.jpg" alt="UTCH logo" />
          <span>UT Canoe &amp; Hiking Club</span>
        </div>
        <div class="footer-info">
          University of Tennessee &bull; Contact: <a href="mailto:utch1968@gmail.com">utch1968@gmail.com</a>
        </div>
      </div>
    </footer>
  </body>
</html>
